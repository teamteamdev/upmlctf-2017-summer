# Online shopping 1: Write-up

Заходим на сайт, видим два товара. Понятно, что наша цель — купить «Флаг CTF».

Для покупки нужно ввести номер карты. Так как в HTML-коде написано
`minlength="16" maxlength="16"`, пробуем вводить 16-значные варианты.
Оказывается, что подходит любое число из 16 цифр.

Далее, открывается страница с адресом вида
`https://web100.ctf.upml.tech/process/?id=2&price=29.99&card=1111111111111111`

На странице нам нужно ввести SMS-код подтверждения. Мы его, конечно, не знаем.

Заметим, что есть и бесплатный товар: Флаг Франции. Для его покупки тоже нужен
номер карты.

После ввода карты нам показывается ссылка на флаг, при этом адресная строка выглядит так:
`https://web100.ctf.upml.tech/process/?id=1&price=0&card=1111111111111111`

При этом код SMS-подтверждения вводить не требуется и ссылка показывается сразу.
Как же определяется, нужно подтверждение или нет? В адресной строке есть
параметр `price`. Можно ли его поменять?

Давайте попробуем:
`https://web100.ctf.upml.tech/process/?id=2&price=0&card=1111111111111111`

Теперь и флаг CTF продаётся без SMS-подтверждения. Откроем и получим флаг.

Флаг: **uctf_easy_shop_backdoor**
